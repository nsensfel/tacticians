module Battle.Struct.DamageType exposing
   (
      Type(..),
      encode,
      decode,
      to_string
   )

-- Elm -------------------------------------------------------------------------

-- Battle ----------------------------------------------------------------------

--------------------------------------------------------------------------------
-- TYPES -----------------------------------------------------------------------
--------------------------------------------------------------------------------
type Type =
   Base
   | Slash
   | Blunt
   | Pierce
   | None

--------------------------------------------------------------------------------
-- LOCAL -----------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- EXPORTED --------------------------------------------------------------------
--------------------------------------------------------------------------------
decode : String -> Type
decode str =
   case str of
      "bse" -> Base
      "slh" -> Slash
      "pie" -> Pierce
      "blu" -> Blunt
      _ -> None

encode : Type -> String
encode t =
   case t of
      Base -> "bse"
      Slash -> "slh"
      Pierce -> "pie"
      Blunt -> "blu"
      None  -> "non"

to_string : Type -> String
to_string t =
   case t of
      Base -> "Base"
      Slash -> "Slash"
      Pierce -> "Piercing"
      Blunt -> "Bludgeoning"
      None  -> "ERROR"
