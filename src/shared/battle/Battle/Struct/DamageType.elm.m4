module Battle.Struct.DamageType exposing
   (
      Type(..),
      encode,
      decode,
      to_string
   )

-- Elm -------------------------------------------------------------------------

-- Battle ----------------------------------------------------------------------

--------------------------------------------------------------------------------
-- TYPES -----------------------------------------------------------------------
--------------------------------------------------------------------------------
type Type =
   Slash
   | Blunt
   | Pierce

--------------------------------------------------------------------------------
-- LOCAL -----------------------------------------------------------------------
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
-- EXPORTED --------------------------------------------------------------------
--------------------------------------------------------------------------------

m4_include(__MAKEFILE_DATA_DIR/names.m4.conf)

decode : String -> Type
decode str =
   case str of
      "__SN_SLASH" -> Slash
      "__SN_PIERCE" -> Pierce
      _ -> Blunt

encode : Type -> String
encode t =
   case t of
      Slash -> "__SN_SLASH"
      Pierce -> "__SN_PIERCE"
      Blunt -> "__SN_BLUNT"

to_string : Type -> String
to_string t =
   case t of
      Slash -> "Slash"
      Pierce -> "Piercing"
      Blunt -> "Bludgeoning"
